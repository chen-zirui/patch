package com;
import org.junit.Test;
import java.security.Key;
import org.jose4j.keys.AesKey;
import org.jose4j.lang.ByteUtil;

public class EncodingUtilsExploitTest {
    @Test(timeout=10000)
    public void testDecrypt() {
        Key key = new AesKey(ByteUtil.randomBytes(16));
        final String xml = "\"eyJhbGciOiJQQkVTMi1IUzI1NitBMTI4S1ciLCJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwicDJjIjoyMDAwMDAwMDAwLCJwMnMiOiJ1RWxQUGhJLThGY2h3a1BhIn0=.JOIw8ccIdkor7-ZaHQz6pUkqj2VEL_XIuonOwdSrdeXxFb7qN8FZKw.1-ZgAG8KzCbl6wDjUzrsTw.0pLJ0ZEu9OMYV1jyfPIrqg.gFNkCEwB1lf_Jovc7ZOd5w\"";
        EncodingUtils  example = new EncodingUtils();
        try {
            example.decryptJwtValue(key, xml);
        } catch (Exception e) {
            // Test is considered successful even if an exception is thrown
        }
       
    }
}
